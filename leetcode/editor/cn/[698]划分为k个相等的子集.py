# ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ­£æ•´æ•° kï¼Œæ‰¾å‡ºæ˜¯å¦æœ‰å¯èƒ½æŠŠè¿™ä¸ªæ•°ç»„åˆ†æˆ k ä¸ªéç©ºå­é›†ï¼Œå…¶æ€»å’Œéƒ½ç›¸ç­‰ã€‚ 
# 
#  
# 
#  ç¤ºä¾‹ 1ï¼š 
# 
#  
# è¾“å…¥ï¼š nums = [4, 3, 2, 3, 5, 2, 1], k = 4
# è¾“å‡ºï¼š True
# è¯´æ˜ï¼š æœ‰å¯èƒ½å°†å…¶åˆ†æˆ 4 ä¸ªå­é›†ï¼ˆ5ï¼‰ï¼Œï¼ˆ1,4ï¼‰ï¼Œï¼ˆ2,3ï¼‰ï¼Œï¼ˆ2,3ï¼‰ç­‰äºæ€»å’Œã€‚ 
# 
#  ç¤ºä¾‹ 2: 
# 
#  
# è¾“å…¥: nums = [1,2,3,4], k = 3
# è¾“å‡º: false 
# 
#  
# 
#  æç¤ºï¼š 
# 
#  
#  1 <= k <= len(nums) <= 16 
#  0 < nums[i] < 10000 
#  æ¯ä¸ªå…ƒç´ çš„é¢‘ç‡åœ¨ [1,4] èŒƒå›´å†… 
#  
#  Related Topics ä½è¿ç®— è®°å¿†åŒ–æœç´¢ æ•°ç»„ åŠ¨æ€è§„åˆ’ å›æº¯ çŠ¶æ€å‹ç¼© ğŸ‘ 561 ğŸ‘ 0


# leetcode submit region begin(Prohibit modification and deletion)
class Solution(object):
    def canPartitionKSubsets(self, nums, k):
        """
        :type nums: List[int]
        :type k: int
        :rtype: bool
        """

        # åˆ’åˆ†å­é›†çš„ç›®æ ‡å€¼
        target, rem = divmod(sum(nums), k)
        # å¦‚æœä¸èƒ½æ•´é™¤ï¼Œå¯ä»¥ç›´æ¥è¿”å›
        if rem: return False

        # é€’å½’è°ƒç”¨ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥ç”¨å½“å‰çš„numsæ•°ç»„å»å‡‘åˆ°kä¸ªtarget
        # æ³¨æ„ï¼Œè¿™é‡Œæœ‰é€’å½’è°ƒç”¨ï¼Œå†æ¬¡åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œgroupsè¿˜æ˜¯é‚£ä¸ªgroupsï¼Œä½†æ˜¯numsä¸æ˜¯å½“åˆçš„numsäº†
        def search(groups):
            # æ•´ä¸ªnumsæ•°ç»„å·²ç»å…¨ç”¨å®Œäº†ï¼Œè¿˜æ²¡æœ‰ä»é€’å½’ä¸­returnä¸Šæ¥ï¼Œè¯´æ˜å¯ä»¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œæ‰€ä»¥return True
            if not nums: return True
            # ä»numsä¸­å–å‡ºæœ€å¤§çš„æ•°
            v = nums.pop()
            # åˆ¤æ–­æ”¾åˆ°å“ªä¸ªç»„é‡Œé¢
            for i, group in enumerate(groups):
                # å¦‚æœè¿™ä¸ªç»„åŠ ä¸Šè¿™ä¸ªæ•°vï¼Œè¿˜æ²¡æœ‰è¶…è¿‡target
                if group + v <= target:
                    # é‚£ä¹ˆå°±æŠŠè¿™ä¸ªæ•°æ”¾åˆ°è¿™ä¸ªç»„é‡Œ
                    groups[i] += v
                    # ç»§ç»­åˆ¤æ–­åç»­èƒ½å¦å®Œæˆä»»åŠ¡ï¼Œå¦‚æœå¯ä»¥ï¼Œç›´æ¥è¿”å›Trueï¼Œè¿™ä¼šåœ¨é€’å½’ä¸­ä¸€è·¯è¿”å›ä¸Šå»
                    # åœ¨è¿™é‡Œé€’å½’æ‰¾åˆ°våº”è¯¥æ”¾åˆ°å“ªä¸ªç»„é‡Œé¢
                    if search(groups): return True
                    # å¦åˆ™ï¼Œè¿™ä¸ªæ•°ä¸åº”è¯¥æ”¾åˆ°è¿™ä¸ªç»„é‡Œï¼ŒæŠŠvä»è¿™ä¸ªç»„é‡Œé¢æ‹¿å‡ºæ¥ï¼Œç»§ç»­å°è¯•å…¶ä»–çš„ç»„
                    groups[i] -= v
                # å¦‚æœè¿™ä¸ªç»„æœ‰æ•°å­—äº†ï¼Œå…ˆä¸è¦å¾€è¿™ä¸ªç»„æ”¾äº†ï¼Œå»æ”¾åˆ°ä¸‹ä¸€ä¸ªç»„
                # æ„Ÿè§‰ä¹Ÿæœ‰ç‚¹å¯å‘å¼ç®—æ³•çš„æ„æ€ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆæå‘¢ï¼Ÿ
                # å› ä¸ºæ•°ç»„è¢«æ’åºäº†ï¼Œå•è°ƒæ€§åŸç†
                if not group:
                    # print("break ... ")
                    break
            # print('nums:', nums, 'v:', v, 'Groups:', groups)
            # æ‰¾äº†ä¸€åœˆå‘ç°væ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œå¿…é¡»æŠŠvæ”¾å›å»åŸæ¥çš„æ•°ç»„
            nums.append(v)
            # å¹¶ä¸”è¿”å›Falseï¼Œè¡¨ç¤ºè¿™æ¬¡å›æº¯æ˜¯å¤±è´¥çš„ï¼Œè¿™ä¸ªvæ²¡æœ‰æ‰¾åˆ°å¯¹åº”ä½ç½®
            return False

        # æ’åºï¼Œæœ‰åŠ©äºå¿«é€Ÿæ‹¿åˆ°ç»“æœ
        nums.sort()
        # å¦‚æœæœ‰æ¯”ç›®æ ‡å€¼å¤§çš„æ•°å€¼åœ¨é‡Œé¢ï¼Œå¯ä»¥ç›´æ¥è¿”å›FALSE
        if nums[-1] > target: return False
        # å¦‚æœæœ‰ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆç›¸ç­‰çš„å¿…ç„¶è‡ªå·±æˆç»„ï¼Œä¹Ÿä¸éœ€è¦åˆ¤æ–­ï¼Œä»numsä¸­å»é™¤ï¼Œå¹¶ä¸”å‡å°‘ç»„çš„æ•°ç›®
        while nums and nums[-1] == target:
            nums.pop()
            k -= 1

        return search([0] * k)
# leetcode submit region end(Prohibit modification and deletion)
